#-*- coding: shift-jis -*-
#:kivy 1.10.1
#:include ./data/kv_template/set_widget.kv

BoxLayout:
    orientation: 'vertical'

    logo_size: 32
    icon_size: 16

    canvas.before:
        Color:
            rgb: .6, .6, .6
        Rectangle:
            size: self.size
            source: 'data/background.png'

    ActionBar:
        id: ab
        size_hint_y: None
        height: 40
        ActionView:
            id: av
            ActionPrevious:
                id: av_prev
                title: app.screen_title
                app_icon: 'data/icons/document.png'
                app_icon_height: root.logo_size
                app_icon_width: root.logo_size
                with_previous: True
                previous_image: 'data/icons/go_prev.png'
                previous_image_height: root.logo_size/2
                previous_image_width: root.logo_size/2
                on_release: app.go_previous_screen()
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionGroup:
                id: av_tmsize
                mode: 'spinner'
                #overflow_image: 'data/icons/thumbnail.png'
                ActionButton:
                    text: '極小アイコン'
                    on_press: app.view_size=0.5
                ActionButton:
                    text: '小アイコン'
                    on_press: app.view_size=1
                ActionButton:
                    text: '中アイコン'
                    on_press: app.view_size=2
                ActionButton:
                    text: '大アイコン'
                    on_press: app.view_size=4

            ActionToggleButton:
                id: tagsetting
                text: 'リンク'
                icon: 'data/icons/share.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                #on_release: app.open_tag_setting()
                on_release: app.change_mode('link') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]
            
            ActionButton:
                id: filter
                text: 'フィルタ'
                icon: 'data/icons/filter.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                on_release: app.open_filter_popup()
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionToggleButton:
                id: tagsetting
                text: 'タグ'
                icon: 'data/icons/tag.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                #on_release: app.open_tag_setting()
                on_release: app.change_mode('tag') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionToggleButton:
                id: favorite
                text: 'お気に入り'
                icon: 'data/icons/star.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                on_release: app.change_mode('favorite') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionToggleButton:
                id: chapter
                text: 'しおり'
                icon: 'data/icons/bookmark.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                on_release: app.change_mode('chapter') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]
            
            ActionToggleButton:
                id: select
                text: '選択'
                icon: 'data/icons/select.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                on_release: app.change_mode('select') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionToggleButton:
                id: select
                text: 'ヘルプ'
                icon: 'data/icons/question.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                on_release: app.view_help(self)

            ActionButton:
                id: select
                text: '設定'
                icon: 'data/icons/config.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                on_release: app.open_settings()

            ActionButton:
                id: select
                text: '終了'
                icon: 'data/icons/batsu.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                on_release: app.exit_app()
            

    StackLayout:
        id: additional_option
        orientation:'rl-tb'
        size_hint_y: None
        height: 0

        canvas.before:
            Color:
                rgba: 0.128, 0.128, 0.128, 1
            Rectangle:
                size: self.size
                pos: self.pos
    
    ScreenManager:
        id: sm
