#-*- coding: shift-jis -*-
#:kivy 1.10.1
#:import KivyLexer kivy.extras.highlight.KivyLexer
#:import Factory kivy.factory.Factory

BoxLayout:
    orientation: 'vertical'

    logo_size: 32
    icon_size: 16

    canvas.before:
        Color:
            rgb: .6, .6, .6
        Rectangle:
            size: self.size
            source: 'data/background.png'

    ActionBar:
        id: ab
        size_hint_y: None
        height: 40
        ActionView:
            id: av
            ActionPrevious:
                id: av_prev
                title: 'MyDataBase'
                app_icon: 'data/icons/document.png'
                app_icon_height: root.logo_size
                app_icon_width: root.logo_size
                with_previous: True
                previous_image: 'data/icons/go_prev.png'
                previous_image_height: root.logo_size/2
                previous_image_width: root.logo_size/2
                on_release: app.go_previous_screen()
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionGroup:
                id: av_tmsize
                mode: 'spinner'
                #overflow_image: 'data/icons/thumbnail.png'
                ActionButton:
                    text: '極小アイコン'
                    on_press: app.view_size=0.5
                ActionButton:
                    text: '小アイコン'
                    on_press: app.view_size=1
                ActionButton:
                    text: '中アイコン'
                    on_press: app.view_size=2
                ActionButton:
                    text: '大アイコン'
                    on_press: app.view_size=4

            ActionToggleButton:
                id: trash
                text: 'ゴミ箱'
                icon: 'data/icons/trash.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                on_release: app.change_mode('trash') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionToggleButton:
                id: favorite
                text: 'お気に入り'
                icon: 'data/icons/star.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                on_release: app.change_mode('favorite') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionToggleButton:
                id: chapter
                text: 'しおり'
                icon: 'data/icons/bookmark.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                group: 'select_mode'
                on_release: app.change_mode('chapter') if(self.state=='down') else app.change_mode('normal')
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

            ActionButton:
                id: filter
                text: 'フィルタ'
                icon: 'data/icons/filter.png'
                icon_height: root.icon_size
                icon_width: root.icon_size
                on_release: app.open_filter_popup()
                color: [1,1,1,0] if app.hide_menu else [1, 1, 1, 1]

    StackLayout:
        id: additional_option
        orientation:'rl-tb'
        size_hint_y: None
        height: 0

        canvas.before:
            Color:
                rgba: 0.128, 0.128, 0.128, 1
            Rectangle:
                size: self.size
                pos: self.pos
    
    ScreenManager:
        id: sm
        Screen:
            name: 'InitialScreen'
            BoxLayout:
                Button:
                    text: 'load'
                    on_release: app.go_thumbnailview('data/__tmp__/test_images/花/daisy')
    
    ProgressBar:
        id: pb
        size_hint_y: None
        height: 10
        value: app.progress


<ThumbnailJump@Button>:
    text: ''
    font_size: 16
    background_color: 0.6, 0.6, 0.6, 0.8
    on_press: app.change_thumbnailview(self)

<JumpPopUp@BoxLayout>:
	orientation: 'vertical'
    spacing: 10
    
    input_text: ''

    AnchorLayout:
        anchor_x:'center'
        size_hint_y:None
        height: 30
        TextInput:
            text: ''
            hint_text:  '1 - {}'.format(app.divided_num)
            on_text: root.input_text = self.text
            multiline: False
 
	BoxLayout:
		orientation: 'horizontal'
		Button:
			size_hint: .5, 1
			text: 'OK'
			on_release: app.jump_thumbnail(root.input_text)
 
		Button:
			size_hint: .5, 1
			text: 'キャンセル'
			on_release: app.close_popup()

<ClickableLabel@ButtonBehavior+Label>:
    #text_size: self.size
    size: self.texture_size
    halign: 'left'
    #valign: 'center'
    font_size: '16sp'
    #color: 0, 0, 0, 1

<FilterItem@BoxLayout>:
    text: ''
    #size_hint: None, None
    #size: 150, 50
    size_hint: None, None
    height: 40
    width: self.minimum_width
    CheckBox:
        id: cb
        #color: 0, 0.4, 1.0, 1.0
        size_hint_x: None
        width: '32dp'
    ClickableLabel:
        on_press: cb._do_press()
        size_hint_x:None
        text: root.text